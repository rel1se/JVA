/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java application project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/8.0/userguide/building_java_projects.html
 */




plugins {
   id 'java'

}


sourceSets {
   main {
      java {
         srcDir 'src'
      }
   }
}

jar {
	 archiveBaseName = 'test'
   destinationDirectory = file("jars")
   manifest {
      attributes 'Main-Class': 'App'
   }
}


task exec {
   dependsOn "jar"
   doLast {
      exec {
         commandLine 'docker', 'build', '-t', 'myimage', './jars'
      }
      exec {
         commandLine 'docker', 'run', '-p', '80:80', '--name', 'mycont', 'myimage'
      }

      delete 'build'

      exec {
         commandLine 'docker', 'rm', 'mycont'
      }
      exec {
         commandLine 'docker', 'rmi', 'myimage'
      }
   }
}

